<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Refleksi 5 - Pemangkasan Teknik Layer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }
    h3 { margin-bottom: 6px; }
    p { margin-bottom: 14px; text-align: justify; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #000; padding: 6px; font-size: 14px; vertical-align: middle; }
    th { background-color: #eee; text-align: center; }
    td:nth-child(1) { text-align: center; width: 40px; }
    td:nth-child(3), td:nth-child(4) { text-align: center; width: 80px; }
    .left { text-align: left; }
    input[type="checkbox"] { transform: scale(1.15); cursor: pointer; }
    button { margin-top: 15px; padding: 8px 16px; font-size: 14px; cursor: pointer; }
    button + button { margin-left: 10px; }
  </style>
</head>
<body>
  <h3>Refleksi 5</h3>
  <p>
    Menguraikan teknik dan prosedur penataan pada desain pemangkasan rambut teknik <b>Layer</b>.  
    Ukurlah kemampuan pemahaman Anda terhadap penyajian materi pengetahuan pada pembelajaran 5,  
    dengan mengisi tabel kuisioner berikut ini.
  </p>

  <table>
    <thead>
      <tr>
        <th rowspan="2">No</th>
        <th rowspan="2">Pernyataan</th>
        <th colspan="2">Pemahaman</th>
      </tr>
      <tr>
        <th>Ya</th>
        <th>Tidak</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td class="left">Saya dapat menganalisis konsep pemangkasan rambut dasar dan penataan (teknik layer)</td>
        <td><input type="checkbox" id="r5-q1-yes" data-pair="r5-q1-no"></td>
        <td><input type="checkbox" id="r5-q1-no"  data-pair="r5-q1-yes"></td>
      </tr>
      <tr>
        <td>2</td>
        <td class="left">Saya dapat menganalisis jenis-jenis pemangkasan rambut dasar (teknik layer)</td>
        <td><input type="checkbox" id="r5-q2-yes" data-pair="r5-q2-no"></td>
        <td><input type="checkbox" id="r5-q2-no"  data-pair="r5-q2-yes"></td>
      </tr>
      <tr>
        <td>3</td>
        <td class="left">Saya dapat menganalisis komponen desain pemangkasan uniform layer</td>
        <td><input type="checkbox" id="r5-q3-yes" data-pair="r5-q3-no"></td>
        <td><input type="checkbox" id="r5-q3-no"  data-pair="r5-q3-yes"></td>
      </tr>
      <tr>
        <td>4</td>
        <td class="left">Saya dapat menerapkan prosedur pemangkasan uniform layer</td>
        <td><input type="checkbox" id="r5-q4-yes" data-pair="r5-q4-no"></td>
        <td><input type="checkbox" id="r5-q4-no"  data-pair="r5-q4-yes"></td>
      </tr>
      <tr>
        <td>5</td>
        <td class="left">Saya dapat menganalisis komponen desain pemangkasan increase layer</td>
        <td><input type="checkbox" id="r5-q5-yes" data-pair="r5-q5-no"></td>
        <td><input type="checkbox" id="r5-q5-no"  data-pair="r5-q5-yes"></td>
      </tr>
      <tr>
        <td>6</td>
        <td class="left">Saya dapat menerapkan prosedur pemangkasan increase layer</td>
        <td><input type="checkbox" id="r5-q6-yes" data-pair="r5-q6-no"></td>
        <td><input type="checkbox" id="r5-q6-no"  data-pair="r5-q6-yes"></td>
      </tr>
      <tr>
        <td>7</td>
        <td class="left">Saya dapat menerapkan penampilan secara keseluruhan (total look) dan mengakhiri pemangkasan rambut dasar (teknik layer)</td>
        <td><input type="checkbox" id="r5-q7-yes" data-pair="r5-q7-no"></td>
        <td><input type="checkbox" id="r5-q7-no"  data-pair="r5-q7-yes"></td>
      </tr>
    </tbody>
  </table>

  <button onclick="saveProgress()">Simpan</button>
  <button onclick="exportToDoc()">Download ke Word</button>

  <script>
    // daftar id untuk Refleksi 5 (7 pernyataan × Ya/Tidak)
    const ids5 = [
      'r5-q1-yes','r5-q1-no',
      'r5-q2-yes','r5-q2-no',
      'r5-q3-yes','r5-q3-no',
      'r5-q4-yes','r5-q4-no',
      'r5-q5-yes','r5-q5-no',
      'r5-q6-yes','r5-q6-no',
      'r5-q7-yes','r5-q7-no'
    ];

    // muat state dari localStorage & pasang listener eksklusif
    window.addEventListener('DOMContentLoaded', () => {
      ids5.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.checked = localStorage.getItem(id) === 'true';
      });

      // Buat Ya/Tidak saling eksklusif per baris
      document.querySelectorAll('input[type="checkbox"][data-pair]').forEach(cb => {
        cb.addEventListener('change', (e) => {
          const pairId = e.target.getAttribute('data-pair');
          const pair = document.getElementById(pairId);
          if (e.target.checked && pair) pair.checked = false;
        });
      });
    });

    function saveProgress() {
      ids5.forEach(id => {
        const el = document.getElementById(id);
        if (el) localStorage.setItem(id, el.checked);
      });
      alert('Jawaban berhasil disimpan.');
    }

    function exportToDoc() {
      const questions = [
        "Saya dapat menganalisis konsep pemangkasan rambut dasar dan penataan (teknik layer)",
        "Saya dapat menganalisis jenis-jenis pemangkasan rambut dasar (teknik layer)",
        "Saya dapat menganalisis komponen desain pemangkasan uniform layer",
        "Saya dapat menerapkan prosedur pemangkasan uniform layer",
        "Saya dapat menganalisis komponen desain pemangkasan increase layer",
        "Saya dapat menerapkan prosedur pemangkasan increase layer",
        "Saya dapat menerapkan penampilan secara keseluruhan (total look) dan mengakhiri pemangkasan rambut dasar (teknik layer)"
      ];

      let rowsHtml = `
        <tr><th rowspan='2'>No</th><th rowspan='2'>Pernyataan</th><th colspan='2'>Pemahaman</th></tr>
        <tr><th>Ya</th><th>Tidak</th></tr>`;

      questions.forEach((q, i) => {
        const yesId = `r5-q${i+1}-yes`;
        const noId  = `r5-q${i+1}-no`;
        const yes = document.getElementById(yesId) && document.getElementById(yesId).checked;
        const no  = document.getElementById(noId)  && document.getElementById(noId).checked;
        rowsHtml += `
          <tr>
            <td style="text-align:center">${i+1}</td>
            <td>${q}</td>
            <td style="text-align:center">${yes ? '✓' : ''}</td>
            <td style="text-align:center">${no  ? '✓' : ''}</td>
          </tr>`;
      });

      const html = `
        <html xmlns:o='urn:schemas-microsoft-com:office:office'
              xmlns:w='urn:schemas-microsoft-com:office:word'
              xmlns='http://www.w3.org/TR/REC-html40'>
        <head><meta charset='utf-8'><title>Refleksi 5</title></head><body>
        <h2>Refleksi 5</h2>
        <p>Menguraikan teknik dan prosedur penataan pada desain pemangkasan rambut teknik Layer. Ukurlah kemampuan pemahaman Anda terhadap penyajian materi pengetahuan pada pembelajaran 5, dengan mengisi tabel kuisioner berikut ini.</p>
        <table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;width:100%'>
          ${rowsHtml}
        </table></body></html>`;

      const blob = new Blob(['\ufeff' + html], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'Refleksi_5_Pemangkasan_Teknik_Layer.doc';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
