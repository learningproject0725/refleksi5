<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Refleksi 5 - Pemangkasan Teknik Layer</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }
    h3 { margin-bottom: 5px; }
    p { margin-bottom: 15px; text-align: justify; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #000; padding: 6px; font-size: 14px; vertical-align: middle; }
    th { background-color: #eee; text-align: center; }
    td:nth-child(1) { text-align: center; width: 40px; }
    td:nth-child(3), td:nth-child(4) { text-align: center; width: 60px; }
    input[type="checkbox"] { transform: scale(1.2); cursor: pointer; }
    button { margin-top: 15px; padding: 8px 16px; font-size: 14px; cursor: pointer; }
    button + button { margin-left: 10px; }
  </style>
</head>
<body>
  <h3>Refleksi 5</h3>
  <p>
    Menguraikan teknik dan prosedur penataan pada desain pemangkasan rambut teknik Layer.  
    Ukurlah kemampuan pemahaman Anda terhadap penyajian materi pengetahuan pada pembelajaran 5,  
    dengan mengisi tabel kuisioner berikut ini.
  </p>

  <table>
    <thead>
      <tr>
        <th rowspan="2">No</th>
        <th rowspan="2">Pernyataan</th>
        <th colspan="2">Pemahaman</th>
      </tr>
      <tr>
        <th>Ya</th>
        <th>Tidak</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>Saya dapat menganalisis konsep pemangkasan rambut dasar dan penataan (teknik layer)</td>
        <td><input type="checkbox" id="r5-q1-yes"></td>
        <td><input type="checkbox" id="r5-q1-no"></td>
      </tr>
      <tr>
        <td>2</td>
        <td>Saya dapat menganalisis jenis-jenis pemangkasan rambut dasar (teknik layer)</td>
        <td><input type="checkbox" id="r5-q2-yes"></td>
        <td><input type="checkbox" id="r5-q2-no"></td>
      </tr>
      <tr>
        <td>3</td>
        <td>Saya dapat menganalisis komponen desain pemangkasan uniform layer</td>
        <td><input type="checkbox" id="r5-q3-yes"></td>
        <td><input type="checkbox" id="r5-q3-no"></td>
      </tr>
      <tr>
        <td>4</td>
        <td>Saya dapat menerapkan prosedur pemangkasan uniform layer</td>
        <td><input type="checkbox" id="r5-q4-yes"></td>
        <td><input type="checkbox" id="r5-q4-no"></td>
      </tr>
      <tr>
        <td>5</td>
        <td>Saya dapat menganalisis komponen desain pemangkasan increase layer</td>
        <td><input type="checkbox" id="r5-q5-yes"></td>
        <td><input type="checkbox" id="r5-q5-no"></td>
      </tr>
      <tr>
        <td>6</td>
        <td>Saya dapat menerapkan prosedur pemangkasan increase layer</td>
        <td><input type="checkbox" id="r5-q6-yes"></td>
        <td><input type="checkbox" id="r5-q6-no"></td>
      </tr>
      <tr>
        <td>7</td>
        <td>Saya dapat menerapkan penampilan secara keseluruhan (total look)</td>
        <td><input type="checkbox" id="r5-q7-yes"></td>
        <td><input type="checkbox" id="r5-q7-no"></td>
      </tr>
      <tr>
        <td>8</td>
        <td>Saya dapat mengakhiri pemangkasan rambut dasar (teknik layer)</td>
        <td><input type="checkbox" id="r5-q8-yes"></td>
        <td><input type="checkbox" id="r5-q8-no"></td>
      </tr>
    </tbody>
  </table>

  <button onclick="saveProgress()">Simpan</button>
  <button onclick="exportToDoc()">Download ke Word</button>

  <script>
    // daftar id untuk Refleksi 5
    const ids5 = [
      'r5-q1-yes','r5-q1-no',
      'r5-q2-yes','r5-q2-no',
      'r5-q3-yes','r5-q3-no',
      'r5-q4-yes','r5-q4-no',
      'r5-q5-yes','r5-q5-no',
      'r5-q6-yes','r5-q6-no',
      'r5-q7-yes','r5-q7-no',
      'r5-q8-yes','r5-q8-no'
    ];

    window.onload = () => {
      ids5.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.checked = localStorage.getItem(id) === 'true';
      });
    };

    function saveProgress() {
      ids5.forEach(id => {
        const el = document.getElementById(id);
        if (el) localStorage.setItem(id, el.checked);
      });
      alert('Jawaban berhasil disimpan.');
    }

    function exportToDoc() {
      let rows = `
        <tr><th rowspan='2'>No</th><th rowspan='2'>Pernyataan</th><th colspan='2'>Pemahaman</th></tr>
        <tr><th>Ya</th><th>Tidak</th></tr>`;
      
      const questions = [
        "Saya dapat menganalisis konsep pemangkasan rambut dasar dan penataan (teknik layer)",
        "Saya dapat menganalisis jenis-jenis pemangkasan rambut dasar (teknik layer)",
        "Saya dapat menganalisis komponen desain pemangkasan uniform layer",
        "Saya dapat menerapkan prosedur pemangkasan uniform layer",
        "Saya dapat menganalisis komponen desain pemangkasan increase layer",
        "Saya dapat menerapkan prosedur pemangkasan increase layer",
        "Saya dapat menerapkan penampilan secara keseluruhan (total look)",
        "Saya dapat mengakhiri pemangkasan rambut dasar (teknik layer)"
      ];

      questions.forEach((q, i) => {
        rows += `
          <tr>
            <td>${i+1}</td>
            <td>${q}</td>
            <td>${document.getElementById('r5-q'+(i+1)+'-yes').checked ? '✓' : ''}</td>
            <td>${document.getElementById('r5-q'+(i+1)+'-no').checked ? '✓' : ''}</td>
          </tr>`;
      });

      const html = `
        <html xmlns:o='urn:schemas-microsoft-com:office:office'
              xmlns:w='urn:schemas-microsoft-com:office:word'
              xmlns='http://www.w3.org/TR/REC-html40'>
        <head><meta charset='utf-8'><title>Refleksi 5</title></head><body>
        <h2>Refleksi 5</h2>
        <table border='1' cellpadding='6' cellspacing='0'>${rows}</table>
        </body></html>`;

      const blob = new Blob(['\ufeff' + html], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'Refleksi_5_Pemangkasan_Teknik_Layer.doc';
      link.click();
    }
  </script>
</body>
</html>
